const EXPLOSION_WIDTH=171,EXPLOSION_HEIGHT=171;var desktopRect=newRectXYWH(0,800,600,200),arrowRect=newRectXYWH(268,660,64,160);const MAX_LOCUS_LENGTH=10;var colliXY=new ivec2(0,0),locus=[];function drawBalls(t){if(0<fallingBalls.length){for(let l=0;l<fallingBalls.length;++l){var e,L,a;null!=fallingBalls[l]&&(L=(e=fallingBalls[l]).x-BALL_HALF_WIDTH,a=e.y-BALL_HALF_HEIGHT,t.globalAlpha=e.fallingMsecs/BALL_FALLING_MSECS,ballTex.draw(t,L,a,BALL_WIDTH,BALL_HEIGHT,1,e.colorIndex))}t.globalAlpha=1}for(let e=0;e<BALL_ROWS;++e)for(let l=0;l<BALL_COLS;++l)if(null!=ballArr[e][l]){var o=ballArr[e][l],r=o.x-BALL_HALF_WIDTH,B=o.y-BALL_HALF_HEIGHT;if(o.ballType==BALL_BOMB)bombTex.draw(t,r,B,BALL_WIDTH,BALL_HEIGHT,0,0);else{let l=0;o.ballType==BALL_PLUS5&&(l=2),ballTex.draw(t,r,B,BALL_WIDTH,BALL_HEIGHT,l,o.colorIndex)}}var l,c,s,H;if(0<explosionMsecs&&(t.globalAlpha=explosionMsecs/BOMB_EXPLOSION_MSECS,s=exploCentre.x-EXPLOSION_WIDTH/2,H=exploCentre.y-EXPLOSION_HEIGHT/2,explodeTex.draw(t,s,H,EXPLOSION_WIDTH,EXPLOSION_HEIGHT,0,0),t.globalAlpha=1),desktopTex.draw(t,desktopRect.left,desktopRect.top,desktopRect.width(),desktopRect.height(),0,0),0!=angle?(l=curBallRect.left+BALL_HALF_WIDTH,c=curBallRect.top+BALL_HALF_HEIGHT,s=arrowRect.left-l,H=arrowRect.top-c,_=arrowRect.width(),n=arrowRect.height(),t.save(),t.translate(l*densityX,c*densityY),t.rotate(angle),arrowTex.drawScr(t,s*densityX,H*densityY,_*densityX,n*densityY,0,0),t.restore()):arrowTex.draw(t,arrowRect.left,arrowRect.top,arrowRect.width(),arrowRect.height(),0,0),null!=shotBall){var _=shotBall.x-BALL_HALF_WIDTH,n=shotBall.y-BALL_HALF_HEIGHT;if(shotBall.ballType==BALL_BOMB)bombTex.draw(t,_,n,BALL_WIDTH,BALL_HEIGHT,0,0);else{let l=0;shotBall.ballType==BALL_PLUS5&&(l=2),ballTex.draw(t,_,n,BALL_WIDTH,BALL_HEIGHT,l,shotBall.colorIndex)}1==showLocus&&(locus.unshift(new ivec2(shotBall.x,shotBall.y)),locus.length>MAX_LOCUS_LENGTH&&(locus=locus.slice(0,MAX_LOCUS_LENGTH)))}if(0<locus.length){var A=BALL_HALF_WIDTH*densityX;t.lineWidth=1,t.strokeStyle="white";for(let l=0;l<locus.length;++l)t.beginPath(),t.arc(locus[l].x*densityX,locus[l].y*densityY,A,0,2*Math.PI),t.stroke();null!=dbg_span&&(t.strokeStyle="red",t.beginPath(),t.arc(colliXY.x*densityX,colliXY.y*densityY,A,0,2*Math.PI),t.stroke())}if(null!=curBall)if(curBall.ballType==BALL_BOMB)bombTex.draw(t,curBallRect.left,curBallRect.top,BALL_WIDTH,BALL_HEIGHT,0,0);else{let l=0;curBall.ballType==BALL_PLUS5&&(l=2),ballTex.draw(t,curBallRect.left,curBallRect.top,BALL_WIDTH,BALL_HEIGHT,l,curBall.colorIndex)}if(null!=nextBall)if(nextBall.ballType==BALL_BOMB)bombTex.draw(t,nextBallRect.left,nextBallRect.top,BALL_WIDTH,BALL_HEIGHT,0,0);else{let l=0;curBall.ballType==BALL_PLUS5&&(l=2),ballTex.draw(t,nextBallRect.left,nextBallRect.top,BALL_WIDTH,BALL_HEIGHT,l,nextBall.colorIndex)}}